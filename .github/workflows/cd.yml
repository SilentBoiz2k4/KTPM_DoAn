name: CD Pipeline

on:
  push:
    branches: [main]
    paths-ignore:
      - '**.md'
      - '.github/CICD_README.md'
  workflow_dispatch:

env:
  NODE_VERSION: '18'

jobs:
  # ============================================
  # JOB 1: Build Docker Images
  # ============================================
  build-images:
    name: Build Docker Images
    runs-on: ubuntu-latest

    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Build Backend Docker Image
        run: docker build -t backend:${{ github.sha }} ./backend

      - name: Build Frontend Docker Image
        run: docker build -t frontend:${{ github.sha }} ./frontend

      - name: Docker Images Built Successfully
        run: |
          echo "âœ… Backend image: backend:${{ github.sha }}"
          echo "âœ… Frontend image: frontend:${{ github.sha }}"

  # ============================================
  # JOB 2: Deploy Notification
  # ============================================
  deploy-ready:
    name: Ready for Deploy
    runs-on: ubuntu-latest
    needs: build-images

    steps:
      - name: Deployment Ready
        run: |
          echo "ðŸš€ Docker images built successfully!"
          echo "Ready for deployment to staging/production"
          echo ""
          echo "To deploy manually:"
          echo "1. Pull the latest code"
          echo "2. Run: docker-compose up -d --build"
